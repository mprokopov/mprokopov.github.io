<!DOCTYPE html>
<html>
    <head><title>Ansible - Maksym Prokopov personal blog</title>
<meta charset="utf-8"/>
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1.0, user-scalable=no" name="viewport">
<meta name="viewport" content="width=device-width, initial-scale=1">



<script>
 var remark_config = {
   host: 'https://remark.prokopov.me',
   site_id: 'remark',
   no_footer: true
 }
</script>
<script>!function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);</script>


<link rel="stylesheet" href="https://prokopov.me/style.min.2c73c2cce25cfc0bb98b66e51cb2e60843f676f1f0fdc2952591b9e703466039.css">
<script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
<script type='text' src='https://platform.linkedin.com/badges/js/profile.js' async defer ></script>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                                                      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                                                                                                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                                                                                                    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
 })(window,document,'script','dataLayer','GTM-WB9KBZ5');</script>

<script defer data-domain="prokopov.me" src="https://analytics.prokopov.me/js/script.js"></script>
</head>
    <body><div class="header">
    <a class="title" href="/"><div id="title">Maksym Prokopov personal blog</div><div id="description">Idea is a something worth sharing</div></a>
</div>
<div class="nav">
    
    <div class="page-item"><a href="https://prokopov.me/pages/projects/">Projects</a></div>
    
    <div class="page-item"><a href="https://prokopov.me/pages/talks/">Talks</a></div>
    
    <div class="page-item"><a href="https://prokopov.me/pages/about/">About</a></div>
    
</div>


<div class="article">
  <h2><a href="https://prokopov.me/posts/@mprokopov/ansible-containers-d89258cdf5de/">Ansible Containers</a></h2>
  <div class="date">15.08.2017</div>
  <div><p>Long story short. Ansible decided to create separate orchestration tool for the managing application containers, which is obviously a mainstream now. And this is straightforward next step after development tools for server state management like Ansible.</p>
<p><a href="https://github.com/ansible/ansible-container" title="https://github.com/ansible/ansible-container"><strong>ansible/ansible-container</strong><br>
_ansible-container - Ansible Container is a tool to build Docker images and orchestrate containers using only Ansible…_github.com</a><a href="https://github.com/ansible/ansible-container"></a></p>
<p>But I was really disappointed with Ansible 2.3, because docker_service module is still broken. I tried all possible combinations of docker, docker-py and docker-compose python modules for ansible on remote host with CoreOS and all of combinations failed with different weird errors like “Dockerfile could not be found” and so on. After all the day trying hard to tackle that issues I gave up and wrote simple “docker-compose up” ansible command :(</p>
<p>And this time I decided to give an ansible-container a try. And … ta da … it fails right away from the start.</p>
<p>Starting Docker build of Ansible Container Conductor image (please be patient)…</p>
<p>Failed with</p>
<pre tabindex="0"><code>ERROR Unknown exception
Traceback (most recent call last):  
File “/Library/Python/2.7/site-packages/container/cli.py”, line 268, in \_\_call\_\_  
getattr(core, u’hostcmd\_{}’.format(args.subcommand))(\*\*vars(args))  
File “/Library/Python/2.7/site-packages/container/\_\_init\_\_.py”, line 28, in \_\_wrapped\_\_  
return fn(\*args, \*\*kwargs)  
File “/Library/Python/2.7/site-packages/container/core.py”, line 150, in hostcmd\_build  
cache=kwargs\[‘cache’\]  
File “/Library/Python/2.7/site-packages/container/docker/engine.py”, line 82, in \_\_wrapped\_\_  
return fn(self, \*args, \*\*kwargs)  
File “/Library/Python/2.7/site-packages/container/\_\_init\_\_.py”, line 28, in \_\_wrapped\_\_  
return fn(\*args, \*\*kwargs)  
File “/Library/Python/2.7/site-packages/container/docker/engine.py”, line 744, in build\_conductor\_image  
nocache=not cache)  
File “/Library/Python/2.7/site-packages/docker/models/images.py”, line 172, in build  
raise BuildError(event.get(‘error’) or event)  
BuildError: The command ‘/bin/sh -c python /get-pip.py &amp;&amp; mkdir -p /etc/ansible/roles /\_ansible/src &amp;&amp; cd /usr/local/bin &amp;&amp; tar -xz — strip-components=1 -f /tmp/docker.tgz’ returned a non-zero code: 2
</code></pre><p>So, we will wait for the product to become more stable to give a try one more time. Because I can not understand where to go with this weird errors.</p>
<p>One more leaking abstraction.</p>
</div>
</div>




<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WB9KBZ5"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

</body>
</html>
