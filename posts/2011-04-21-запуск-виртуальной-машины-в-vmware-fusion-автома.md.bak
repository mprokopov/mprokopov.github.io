---
title: 'UPDATED: Запуск виртуальной машины в VMWare Fusion автоматически при старте системы (в background не работает)'
author: Max Prokopov
type: post
date: 2011-04-21T17:16:37+00:00
url: /2011/04/запуск-виртуальной-машины-в-vmware-fusion-автома/
robotsmeta:
  - index,follow
views:
  - 104
categories:
  - vmware
  - Мак

---
Частым сценарием использования в Mac Server является запуск Windows экземпляра в виртуальном окружении используя VMWare Fusion.

Но бывает неудобной после перезагрузки (особенно если она связана с перезагрузкой по питанию) необходимость вручную стартовать виртуальную машину.

Можно ли настроить автоматический запуск boot time?

Оказывается, можно, и не так уж сложно.

В Mac OS есть отличный механизм автозапуска демонов и агентов boot time, а также перезапуска оных в случае чего &#8212; launchctl (читаем маны).

Для нашего случая необходимо создать следующий скрипт, назовем его /Library/Application Support/VMware Fusion/boot-vm.sh

<pre lang="shell">#!/bin/bash
while [! -e /var/run/vmnet-bridge-vmnet.pid]; do  
sleep 1
done 
"/Library/Application Support/VMware Fusion/vmrun" start "/Users/admins/Documents/Virtual Machines.localized/Windows XP Professional.vmwarevm/Windows XP Professional.vmx"
</pre>

где после start &#8212; путь вашей виртуальной машины.

 

для boot-vm.sh добавим аттрибуты запуска:

<pre lang="shell">chmod +x boot-vm.sh</pre>

и создадим следующий файл  /Library/LaunchDaemons/com.vmware.launchd.fusion-server.plist

<pre lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;        
&lt;key&gt;Label&lt;/key&gt;        
&lt;string&gt;com.vmware.launchd.fusion-server&lt;/string&gt;        &lt;key&gt;ProgramArguments&lt;/key&gt;        
&lt;array&gt;                
&lt;string&gt;/Library/Application Support/VMware Fusion/boot-vm.sh&lt;/string&gt;        &lt;/array&gt;        
&lt;key&gt;RunAtLoad&lt;/key&gt;        
&lt;true/&gt;        
&lt;key&gt;ExitTimeOut&lt;/key&gt;        
&lt;integer&gt;0&lt;/integer&gt;        
&lt;key&gt;LaunchOnlyOnce&lt;/key&gt;        
&lt;true/&gt;        
&lt;key&gt;UserName&lt;/key&gt;        
&lt;string&gt;admins&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;</pre>

теперь должно взлетать

 

проверить, что &#171;все правильно сделал&#187; (с) можно командой

<pre lang="shell">launchctl load com.vmware.launchd.fusion-server.plist</pre>

должно взлететь.

[подробнее на сайте vmware][1]

UPDATE:

в бекграунде vmware fusion не работает, без логона у вас не получится запустить vmware 3 (это работало только для vmware 2

 [1]: http://communities.vmware.com/docs/DOC-6263