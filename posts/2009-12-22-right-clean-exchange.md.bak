---
title: Самый правильный скрипт очистки обменника
author: Max Prokopov
type: post
date: 2009-12-22T14:12:29+00:00
url: /2009/12/right-clean-exchange/
views:
  - 93
categories:
  - администрирование

---
[<img class="alignleft size-full wp-image-37" style="margin-top: 8px; margin-bottom: 8px; margin-left: 10px; margin-right: 10px;" title="Снимок-экрана-2009-12-22-в-16.12.42.png" src="http://blog.nexus.org.ua/wp-content/uploads/2009/12/Снимок-экрана-2009-12-22-в-16.12.42.png" alt="" width="52" height="60" />][1]

Не секрет, что практически у каждой организации есть специальная расшаренная папка для обмена, чаще называемая &#171;файлопомойкой&#187;.

Есть ли хороший способ уборки мусора? Что бы кто-то приезжал на мусоровозе и увозил каждый вечер кучи ненужных файлов подальше от хранилища?

Оказывается есть!
  
Раньше я пользовался простым, как канализационный люк, способом &#171;убить все по расписанию в 00:00&#187; и после пары-тройки случаев потерянных каталогов и файлов пользователи приучивались к долгосрочному хранению в обменнике с осторожностью.

На просторах хабра был выужен гораздо более гуманный и удачный способ очистки Exchange, принципы работы которого я опишу ниже:

1. запускаясь каждый вечер скрипт перекладывает файлы и папки с датой модификации -7 дней (неделю назад) в каталог \_deletion\_queue_.

2. скрипт удаляет из \_deletion\_queue_ каталоги и файлы старше 10 дней.

3. можно создать каталог с именем dont_delete, который не будет очищаться совсем.

Итак, виновник поста: [clear\_exchange\_v2s.vbs][2]

Спасибо автору, Константину Тимохину (k.timokhin@gmail.com)

 [1]: http://blog.nexus.org.ua/wp-content/uploads/2009/12/Снимок-экрана-2009-12-22-в-16.12.42.png
 [2]: /clear_exchange_v2s.vbs